spring:
  datasource:
    url: jdbc:postgresql://localhost:5432/mutr
    username: mutr_admin
    password: 1234
    driver-class-name: org.postgresql.Driver

  security:
    oauth2:
      client:
        registration:
          # 1. Google (Spring Security 내장 제공)
          google:
            client-id: ${GOOGLE_CLIENT_ID}
            client-secret: ${GOOGLE_CLIENT_SECRET}
            scope:
              - profile
              - email

          # 2. Kakao (커스텀 제공자 - provider 설정 필수)
          kakao:
            client-id: ${KAKAO_CLIENT_ID}
            client-secret: ${KAKAO_CLIENT_SECRET}
            client-authentication-method: client_secret_post
            authorization-grant-type: authorization_code
            redirect_uri: "{baseUrl}/login/oauth2/code/kakao"
            scope:
              - profile_nickname
              - account_email
            client-name: Kakao

        provider:
          # Kakao는 내장이 아니므로 API 엔드포인트를 직접 명시해야 함
          kakao:
            authorization-uri: https://kauth.kakao.com/oauth/authorize
            token-uri: https://kauth.kakao.com/oauth/token
            user-info-uri: https://kapi.kakao.com/v2/user/me
            user-name-attribute: id # 카카오는 응답 값의 'id'를 식별자로 사용


  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        format_sql: true
        default_batch_fetch_size: 100 # JSONB 타입 지원을 위한 설정

logging:
  level:
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE # SQL 파라미터 확인용

grpc:
  client:
    # @GrpcClient("mutr-ai-engine")에서 지정한 이름과 정확히 일치해야 함
    mutr-ai-engine:
      # 1. 연결 주소 (프로토콜://호스트:포트)
      # 로컬 테스트 시 'static://' 접두사를 붙이는 것이 가장 안정적
      address: 'static://localhost:50051'

      # 2. 협상 유형 (보안 설정)
      # 개발 단계에서 SSL/TLS를 사용하지 않는다면 반드시 plaintext로 설정
      negotiation-type: plaintext

      # 3. 연결 유지 설정
      enable-keep-alive: true
      keep-alive-without-calls: true
      keep-alive-time: 20s

      # 4. 메시지 크기 제한 (AI 분석 결과가 길어질 경우 대비)
      max-inbound-message-size: 10485760 # 10MB